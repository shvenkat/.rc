startup_message off
vbell off
msgwait 0
msgminwait 0
defutf8 on
deflogin off
hardstatus alwayslastline

# Scrolling
defscrollback 20000
compacthist on
termcapinfo xterm* ti@:te@
altscreen on
#bufferfile /var/run/screen/S-$USER/printscreen

# Enable 256 color terminal
attrcolor b ".i"
termcapinfo xterm 'Co#256:AB=\E[48;5;%dm:AF=\E[38;5;%dm'
defbce "on"

# Monitor windows
defmonitor on
activity ""

# Fit to the current window size, useful with F5/reloads of the profile
fit

# Maintain SSH_AUTH_SOCK link
setenv SSH_AUTH_SOCK $HOME/.ssh/.ssh-agent

# Status bar
#caption always "%{= r}%=%?%h%?"
hardstatus string "%{= dd}%-w%{= BW}%50L>%n* %t%{-}%+w%<  %{= r}%-90=%?%h%?"

###
### Key Bindings
###

escape ^^^^
register x "^^"								#     | Goes with the F12 definition
bindkey -k k2 screen						# F2  | Create new window
bindkey -k k3 eval 'prev' 'fit'				# F3  | Previous Window
bindkey -k k4 eval 'next' 'fit'				# F4  | Next Window
register r ":source $HOME/.screenrc^M"		#     | Goes with F5 definition
bindkey -k k5 eval 'process x' 'process r'	# F5  | Reload profile
bindkey -k k6 detach						# F6  | Detach from this session
bindkey -k k7 copy							# F7  | Enter copy/scrollback mode
register t "A^[OH^k^h"						#     | Goes with the F8 definition
bindkey -k k8 eval 'process x' 'process t'	# F8  | Re-title a window
bindkey -k k9 screen vi "$HOME/.screenrc"	# F9  | Configuration
bindkey -k F2 process x						# F12 | Byobu's escape key
bind R process r							# F12 R | Reload profile
register s "[g G$>^h"						# Goes with F12 ~ definition
bind ~ eval 'process x' 'process s' 'exec sed -i -e "/./,/^$/!d" /var/run/screen/S-$USER/printscreen' 'screen -t PRINTSCREEN view /var/run/screen/S-$USER/printscreen' # F12 ~ | write the buffer to file, open in a new window
bindkey "^[O1;2Q" eval 'split' 				# shift-F2 | horizontal split
bindkey "^[O1;5Q" eval 'split -v' 			# ctrl-F2  | vertical split
bindkey "^[O1;2R" focus up					# shift-F3 | focus up
bindkey "^[O1;2S" focus down				# shift-F4 | focus down
bindkey "^[[15;2~" only						# shift-F5 | kill all splits
bindkey "^[[17;5~" remove					# ctrl-F6  | kill this split
bindkey "^[[26~" eval 'split' 				# shift-F2 | horizontal split
											# ctrl-F2  | sadly, does not work in tty :-(
bindkey "^[[28~" focus up					# shift-F3 | focus up
bindkey "^[[29~" focus down					# shift-F4 | focus down
bindkey "^[[31~" only						# shift-F5 | kill all splits
											# ctrl-F6  | sadly, does not work in tty :-(
register p "^[[5~"
bindkey "^[[5;3~" eval 'msgwait 0' 'msgminwait 0' 'copy' 'process p'		# alt-pageup | scrollback
register n "^[[6~"
bindkey "^[[6;3~" eval 'msgwait 0' 'msgminwait 0' 'copy' 'process n'		# alt-pagedn | scrollback
#bindkey "^[[15;5~" eval 'process x' 'process r' 'stuff ". $BYOBU_PREFIX/bin/byobu-reconnect-sockets^M"' # ctrl-F5 | reconnect gpg/ssh/x sockets
#bindkey "^[[17;2~" eval 'exec touch /var/run/screen/S-$USER/byobu.no-logout' 'detach'   # shift-F6 | detach, but don't logout
#bindkey "^[[32~" eval 'exec touch /var/run/screen/S-$USER/byobu.no-logout' 'detach'	# shift-F6 | detach, but don't logout
bindkey "^A"

# Fix the F1-F4 key mappings in screenrc
#termcapinfo xterm 'k1=\E[11~:k2=\E[12~:k3=\E[13~:k4=\E[14~'
termcapinfo xterm 'k1=\EOP:k2=\EOQ:k3=\EOR:k4=\EOS'
